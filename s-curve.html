<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SESS Project - S-Curve Analysis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .project-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .overview-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .overview-number {
            font-size: 2rem;
            font-weight: bold;
            color: #ffd700;
        }

        .overview-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .controls-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            height: fit-content;
        }

        .chart-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 20px;
            text-align: center;
        }

        .chart-canvas {
            width: 100%;
            height: 400px;
            position: relative;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: #fafafa;
            overflow: hidden;
        }

        .svg-chart {
            width: 100%;
            height: 100%;
        }

        .grid-line {
            stroke: #e0e0e0;
            stroke-width: 1;
        }

        .axis-line {
            stroke: #666;
            stroke-width: 2;
        }

        .axis-label {
            font-size: 12px;
            fill: #666;
            text-anchor: middle;
        }

        .planned-curve {
            fill: none;
            stroke: #4caf50;
            stroke-width: 3;
            stroke-dasharray: 5,5;
        }

        .actual-curve {
            fill: none;
            stroke: #2196f3;
            stroke-width: 4;
        }

        .milestone-point {
            fill: #ff9800;
            stroke: #fff;
            stroke-width: 2;
            cursor: pointer;
        }

        .milestone-point:hover {
            r: 8;
            fill: #f57c00;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-line {
            width: 30px;
            height: 3px;
            border-radius: 2px;
        }

        .legend-planned {
            background: #4caf50;
            border: 2px dashed #4caf50;
            height: 1px;
        }

        .legend-actual {
            background: #2196f3;
        }

        .legend-milestone {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ff9800;
            border: 2px solid #fff;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .kpi-card {
            background: linear-gradient(135deg, #f8f9ff 0%, #e8f4f8 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #667eea;
        }

        .kpi-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 5px;
        }

        .kpi-label {
            font-size: 0.9rem;
            color: #666;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-on-track { background: #4caf50; }
        .status-at-risk { background: #ff9800; }
        .status-delayed { background: #f44336; }

        .phase-progress {
            margin-top: 20px;
        }

        .phase-item {
            background: #f8f9ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .phase-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .phase-name {
            font-weight: 600;
            color: #1e3c72;
        }

        .phase-percentage {
            font-weight: bold;
            color: #4caf50;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #45a049);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .metrics-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-top: 20px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .metric-card {
            background: linear-gradient(135deg, #f8f9ff 0%, #e8f4f8 100%);
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .metric-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .metric-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 10px;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .metric-subtitle {
            font-size: 0.9rem;
            color: #666;
        }

        .forecast-section {
            background: linear-gradient(135deg, #fff8e1 0%, #f3e5f5 100%);
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
            border-left: 5px solid #ff9800;
        }

        .forecast-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #e65100;
            margin-bottom: 15px;
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .forecast-item {
            background: rgba(255,255,255,0.7);
            padding: 15px;
            border-radius: 8px;
        }

        .forecast-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }

        .forecast-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: #e65100;
        }

        .tooltip {
            position: absolute;
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 0.8rem;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .tooltip.show {
            opacity: 1;
        }

        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .overview-card {
                margin-bottom: 15px;
            }
            
            .kpi-grid {
                grid-template-columns: 1fr;
            }
            
            .legend {
                flex-direction: column;
                align-items: center;
            }
        }

        .variance-analysis {
            background: #fff3e0;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #ff9800;
        }

        .variance-title {
            font-weight: bold;
            color: #e65100;
            margin-bottom: 10px;
        }

        .variance-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .variance-item {
            background: rgba(255,255,255,0.8);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .variance-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .variance-positive { color: #4caf50; }
        .variance-negative { color: #f44336; }
        .variance-neutral { color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>📈 SESS PROJECT S-CURVE ANALYSIS</h1>
            <p>Smart Exam Surveillance System - Progress Tracking & Performance Dashboard</p>
            
            <div class="project-overview">
                <div class="overview-card">
                    <div class="overview-number">23%</div>
                    <div class="overview-label">Project Completion</div>
                </div>
                <div class="overview-card">
                    <div class="overview-number">Rp 175M</div>
                    <div class="overview-label">Budget Spent</div>
                </div>
                <div class="overview-card">
                    <div class="overview-number">12</div>
                    <div class="overview-label">Weeks Elapsed</div>
                </div>
                <div class="overview-card">
                    <div class="overview-number">16</div>
                    <div class="overview-label">Weeks Remaining</div>
                </div>
            </div>
        </div>

        <!-- Main Dashboard -->
        <div class="dashboard-grid">
            <!-- S-Curve Chart -->
            <div class="chart-container">
                <div class="chart-title">📊 Project S-Curve Analysis</div>
                <div class="chart-canvas">
                    <svg class="svg-chart" id="sCurveChart">
                        <!-- Grid Lines -->
                        <defs>
                            <pattern id="grid" width="40" height="32" patternUnits="userSpaceOnUse">
                                <path d="M 40 0 L 0 0 0 32" fill="none" stroke="#e0e0e0" stroke-width="1"/>
                            </pattern>
                        </defs>
                        <rect width="100%" height="100%" fill="url(#grid)" />
                        
                        <!-- Axes -->
                        <line x1="60" y1="360" x2="580" y2="360" class="axis-line"/>
                        <line x1="60" y1="360" x2="60" y2="40" class="axis-line"/>
                        
                        <!-- Y-Axis Labels -->
                        <text x="25" y="365" class="axis-label">0%</text>
                        <text x="25" y="285" class="axis-label">25%</text>
                        <text x="25" y="205" class="axis-label">50%</text>
                        <text x="25" y="125" class="axis-label">75%</text>
                        <text x="25" y="45" class="axis-label">100%</text>
                        
                        <!-- X-Axis Labels -->
                        <text x="60" y="385" class="axis-label">Aug</text>
                        <text x="135" y="385" class="axis-label">Sep</text>
                        <text x="210" y="385" class="axis-label">Oct</text>
                        <text x="285" y="385" class="axis-label">Nov</text>
                        <text x="360" y="385" class="axis-label">Dec</text>
                        <text x="435" y="385" class="axis-label">Jan</text>
                        <text x="510" y="385" class="axis-label">Feb</text>
                        
                        <!-- Planned Curve (S-Curve) -->
                        <path d="M 60 360 Q 150 340 210 280 Q 285 180 360 120 Q 435 80 510 50" 
                              class="planned-curve" 
                              id="plannedCurve"/>
                        
                        <!-- Actual Progress Curve -->
                        <path d="M 60 360 L 95 350 L 130 330 L 165 300 L 200 270" 
                              class="actual-curve" 
                              id="actualCurve"/>
                        
                        <!-- Milestone Points -->
                        <circle cx="135" cy="340" r="6" class="milestone-point" data-milestone="M1: Requirements Complete"/>
                        <circle cx="210" cy="300" r="6" class="milestone-point" data-milestone="M2: Design Complete"/>
                        <circle cx="285" cy="220" r="6" class="milestone-point" data-milestone="M3: AI Model Complete"/>
                        <circle cx="360" cy="140" r="6" class="milestone-point" data-milestone="M4: System Integration"/>
                        <circle cx="435" cy="90" r="6" class="milestone-point" data-milestone="M5: Testing Complete"/>
                        <circle cx="510" cy="50" r="6" class="milestone-point" data-milestone="M6: Go-Live"/>
                        
                        <!-- Current Progress Indicator -->
                        <line x1="200" y1="40" x2="200" y2="360" stroke="#f44336" stroke-width="2" stroke-dasharray="3,3"/>
                        <text x="205" y="30" class="axis-label" fill="#f44336">Current</text>
                    </svg>
                </div>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-line legend-planned"></div>
                        <span>Planned Progress</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-line legend-actual"></div>
                        <span>Actual Progress</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-milestone"></div>
                        <span>Milestones</span>
                    </div>
                </div>
            </div>

            <!-- KPI Controls Panel -->
            <div class="controls-panel">
                <h3 style="color: #1e3c72; margin-bottom: 20px;">📊 Key Performance Indicators</h3>
                
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-value">95%</div>
                        <div class="kpi-label">Schedule Performance Index</div>
                        <div style="margin-top: 8px;">
                            <span class="status-indicator status-on-track"></span>
                            <span style="font-size: 0.8rem;">On Track</span>
                        </div>
                    </div>
                    
                    <div class="kpi-card">
                        <div class="kpi-value">92%</div>
                        <div class="kpi-label">Cost Performance Index</div>
                        <div style="margin-top: 8px;">
                            <span class="status-indicator status-on-track"></span>
                            <span style="font-size: 0.8rem;">On Track</span>
                        </div>
                    </div>
                    
                    <div class="kpi-card">
                        <div class="kpi-value">23%</div>
                        <div class="kpi-label">Overall Progress</div>
                        <div style="margin-top: 8px;">
                            <span class="status-indicator status-on-track"></span>
                            <span style="font-size: 0.8rem;">Ahead</span>
                        </div>
                    </div>
                    
                    <div class="kpi-card">
                        <div class="kpi-value">3</div>
                        <div class="kpi-label">Active Risks</div>
                        <div style="margin-top: 8px;">
                            <span class="status-indicator status-at-risk"></span>
                            <span style="font-size: 0.8rem;">Monitor</span>
                        </div>
                    </div>
                </div>

                <div class="phase-progress">
                    <h4 style="color: #1e3c72; margin-bottom: 15px;">🎯 Phase Progress</h4>
                    
                    <div class="phase-item">
                        <div class="phase-header">
                            <span class="phase-name">Project Management</span>
                            <span class="phase-percentage">35%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 35%;"></div>
                        </div>
                    </div>
                    
                    <div class="phase-item">
                        <div class="phase-header">
                            <span class="phase-name">Requirements & Analysis</span>
                            <span class="phase-percentage">85%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 85%;"></div>
                        </div>
                    </div>
                    
                    <div class="phase-item">
                        <div class="phase-header">
                            <span class="phase-name">System Design</span>
                            <span class="phase-percentage">45%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 45%;"></div>
                        </div>
                    </div>
                    
                    <div class="phase-item">
                        <div class="phase-header">
                            <span class="phase-name">AI Model Development</span>
                            <span class="phase-percentage">15%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 15%;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Metrics -->
        <div class="metrics-section">
            <div class="chart-title">📈 Project Performance Metrics</div>
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-icon">💰</div>
                    <div class="metric-title">Budget Performance</div>
                    <div class="metric-value">Rp 175M</div>
                    <div class="metric-subtitle">dari Rp 750M total</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-icon">⏱️</div>
                    <div class="metric-title">Time Performance</div>
                    <div class="metric-value">12/28</div>
                    <div class="metric-subtitle">minggu terlaksana</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-icon">✅</div>
                    <div class="metric-title">Quality Score</div>
                    <div class="metric-value">92%</div>
                    <div class="metric-subtitle">deliverable quality</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-icon">👥</div>
                    <div class="metric-title">Team Utilization</div>
                    <div class="metric-value">87%</div>
                    <div class="metric-subtitle">resource efficiency</div>
                </div>
            </div>
        </div>

        <!-- Variance Analysis -->
        <div class="variance-analysis">
            <div class="variance-title">📊 Schedule & Cost Variance Analysis</div>
            <div class="variance-items">
                <div class="variance-item">
                    <div class="variance-value variance-positive">+2 hari</div>
                    <div>Schedule Variance</div>
                    <small>Ahead of schedule</small>
                </div>
                <div class="variance-item">
                    <div class="variance-value variance-positive">-Rp 25M</div>
                    <div>Cost Variance</div>
                    <small>Under budget</small>
                </div>
                <div class="variance-item">
                    <div class="variance-value variance-neutral">0.95</div>
                    <div>Schedule Performance Index</div>
                    <small>Slightly ahead</small>
                </div>
                <div class="variance-item">
                    <div class="variance-value variance-positive">1.08</div>
                    <div>Cost Performance Index</div>
                    <small>Under budget</small>
                </div>
            </div>
        </div>

        <!-- Forecast Section -->
        <div class="forecast-section">
            <div class="forecast-title">🔮 Project Forecast</div>
            <div class="forecast-grid">
                <div class="forecast-item">
                    <div class="forecast-label">Estimated Completion</div>
                    <div class="forecast-value">25 Feb 2026</div>
                </div>
                <div class="forecast-item">
                    <div class="forecast-label">Forecast Budget</div>
                    <div class="forecast-value">Rp 725M</div>
                </div>
                <div class="forecast-item">
                    <div class="forecast-label">Completion Probability</div>
                    <div class="forecast-value">92%</div>
                </div>
                <div class="forecast-item">
                    <div class="forecast-label">Risk Level</div>
                    <div class="forecast-value">Medium</div>
                </div>
            </div>
        </div>

        <!-- Tooltip -->
        <div id="tooltip" class="tooltip"></div>
    </div>

    <script>
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeAnimations();
            setupInteractivity();
            updateRealTimeData();
        });

        function initializeAnimations() {
            // Animate progress bars
            const progressBars = document.querySelectorAll('.progress-fill');
            progressBars.forEach((bar, index) => {
                const width = bar.style.width;
                bar.style.width = '0%';
                setTimeout(() => {
                    bar.style.width = width;
                }, index * 200 + 500);
            });

            // Animate S-curve drawing
            const actualCurve = document.getElementById('actualCurve');
            const pathLength = actualCurve.getTotalLength();
            actualCurve.style.strokeDasharray = pathLength + ' ' + pathLength;
            actualCurve.style.strokeDashoffset = pathLength;
            
            setTimeout(() => {
                actualCurve.style.transition = 'stroke-dashoffset 2s ease-in-out';
                actualCurve.style.strokeDashoffset = '0';
            }, 1000);
        }

        function setupInteractivity() {
            // Milestone hover effects
            const milestones = document.querySelectorAll('.milestone-point');
            const tooltip = document.getElementById('tooltip');
            
            milestones.forEach(milestone => {
                milestone.addEventListener('mouseenter', function(e) {
                    const milestoneText = this.getAttribute('data-milestone');
                    tooltip.textContent = milestoneText;
                    tooltip.style.left = e.pageX + 10 + 'px';
                    tooltip.style.top = e.pageY - 30 + 'px';
                    tooltip.classList.add('show');
                });
                
                milestone.addEventListener('mouseleave', function() {
                    tooltip.classList.remove('show');
                });
                
                milestone.addEventListener('mousemove', function(e) {
                    tooltip.style.left = e.pageX + 10 + 'px';
                    tooltip.style.top = e.pageY - 30 + 'px';
                });
            });

            // Metric card hover effects
            document.querySelectorAll('.metric-card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-5px) scale(1.02)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });
        }

        function updateRealTimeData() {
            // Simulate real-time updates (in a real project, this would fetch from API)
            setInterval(() => {
                // Update current progress indicator
                const currentDate = new Date();
                const projectStart = new Date('2025-08-01');
                const weeksPassed = Math.floor((currentDate - projectStart) / (7 * 24 * 60 * 60 * 1000));
                
                // Update KPI values with slight variations
                const spiElement = document.querySelector('.kpi-card:nth-child(1) .kpi-value');
                const currentSPI = parseFloat(spiElement.textContent.replace('%', ''));
                const newSPI = Math.max(85, Math.min(105, currentSPI + (Math.random() - 0.5) * 2));
                spiElement.textContent = newSPI.toFixed(0) + '%';
                
                // Update status indicators based on performance
                updateStatusIndicators();
                
            }, 10000); // Update every 10 seconds
        }

        function updateStatusIndicators() {
            const indicators = document.querySelectorAll('.status-indicator');
            const kpiValues = document.querySelectorAll('.kpi-value');
            
            kpiValues.forEach((value, index) => {
                const numValue = parseFloat(value.textContent.replace(/[^0-9.]/g, ''));
                const indicator = indicators[index];
                
                if (index < 2) { // SPI and CPI
                    if (numValue >= 95) {
                        indicator.className = 'status-indicator status-on-track';
                    } else if (numValue >= 85) {
                        indicator.className = 'status-indicator status-at-risk';
                    } else {
                        indicator.className = 'status-indicator status-delayed';
                    }
                }
            });
        }

        // Export functionality (for reports)
        function exportData() {
            const data = {
                projectName: "SESS - Smart Exam Surveillance System",
                currentDate: new Date().toISOString().split('T')[0],
                progress: {
                    overall: 23,
                    budget: 175000000,
                    schedule: 95,
                    quality: 92
                },
                phases: [
                    { name: "Project Management", progress: 35 },
                    { name: "Requirements & Analysis", progress: 85 },
                    { name: "System Design", progress: 45 },
                    { name: "AI Model Development", progress: 15 },
                    { name: "System Development", progress: 0 },
                    { name: "Testing & QA", progress: 0 },
                    { name: "Training & Change Mgmt", progress: 0 },
                    { name: "Deployment & Go-Live", progress: 0 }
                ],
                milestones: [
                    { name: "M1: Requirements Complete", date: "2025-08-31", status: "completed" },
                    { name: "M2: Design Complete", date: "2025-09-30", status: "in-progress" },
                    { name: "M3: AI Model Complete", date: "2025-11-15", status: "planned" },
                    { name: "M4: System Integration", date: "2025-12-15", status: "planned" },
                    { name: "M5: Testing Complete", date: "2026-01-31", status: "planned" },
                    { name: "M6: Go-Live", date: "2026-02-28", status: "planned" }
                ],
                risks: [
                    { name: "AI Accuracy Below Target", level: "High", impact: "Critical" },
                    { name: "User Resistance", level: "Medium", impact: "High" },
                    { name: "Hardware Compatibility", level: "Medium", impact: "Medium" }
                ]
            };
            
            console.log("Project Data Export:", data);
            return data;
        }

        // Generate detailed report
        function generateReport() {
            const reportData = exportData();
            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <html>
                <head>
                    <title>SESS Project Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { background: #1e3c72; color: white; padding: 20px; text-align: center; }
                        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
                        .metric { display: inline-block; margin: 10px; padding: 10px; background: #f5f5f5; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>${reportData.projectName}</h1>
                        <p>Progress Report - ${reportData.currentDate}</p>
                    </div>
                    <div class="section">
                        <h2>Overall Progress</h2>
                        <div class="metric">Overall: ${reportData.progress.overall}%</div>
                        <div class="metric">Budget: Rp ${(reportData.progress.budget/1000000).toFixed(0)}M</div>
                        <div class="metric">Schedule: ${reportData.progress.schedule}%</div>
                        <div class="metric">Quality: ${reportData.progress.quality}%</div>
                    </div>
                    <div class="section">
                        <h2>Phase Progress</h2>
                        ${reportData.phases.map(phase => 
                            `<div class="metric">${phase.name}: ${phase.progress}%</div>`
                        ).join('')}
                    </div>
                    <div class="section">
                        <h2>Milestones</h2>
                        ${reportData.milestones.map(milestone => 
                            `<div class="metric">${milestone.name} (${milestone.date}): ${milestone.status}</div>`
                        ).join('')}
                    </div>
                </body>
                </html>
            `);
        }

        // Chart animation functions
        function animateChart() {
            const chart = document.getElementById('sCurveChart');
            chart.style.opacity = '0';
            chart.style.transform = 'scale(0.8)';
            
            setTimeout(() => {
                chart.style.transition = 'all 0.5s ease';
                chart.style.opacity = '1';
                chart.style.transform = 'scale(1)';
            }, 100);
        }

        // Real-time progress simulation
        function simulateProgress() {
            const phases = [
                { element: '.phase-item:nth-child(1) .progress-fill', target: 40 },
                { element: '.phase-item:nth-child(2) .progress-fill', target: 95 },
                { element: '.phase-item:nth-child(3) .progress-fill', target: 55 },
                { element: '.phase-item:nth-child(4) .progress-fill', target: 25 }
            ];

            phases.forEach((phase, index) => {
                setTimeout(() => {
                    const element = document.querySelector(phase.element);
                    if (element) {
                        element.style.width = phase.target + '%';
                        
                        // Update percentage text
                        const percentageElement = element.parentElement.parentElement.querySelector('.phase-percentage');
                        if (percentageElement) {
                            percentageElement.textContent = phase.target + '%';
                        }
                    }
                }, index * 500);
            });
        }

        // Critical path analysis
        function highlightCriticalPath() {
            const criticalActivities = [
                'Requirements & Analysis',
                'AI Model Development', 
                'System Integration',
                'Testing & QA',
                'Deployment'
            ];
            
            console.log('Critical Path Activities:', criticalActivities);
            
            // Visual highlight would be implemented here
            const criticalPathIndicator = document.createElement('div');
            criticalPathIndicator.innerHTML = `
                <div style="position: fixed; top: 20px; right: 20px; background: #ff9800; color: white; padding: 15px; border-radius: 10px; z-index: 1000;">
                    <strong>🔥 Critical Path Alert</strong><br>
                    Focus on AI Model Development phase
                </div>
            `;
            document.body.appendChild(criticalPathIndicator);
            
            setTimeout(() => {
                criticalPathIndicator.remove();
            }, 5000);
        }

        // Earned Value Management calculations
        function calculateEVM() {
            const totalBudget = 750000000; // Rp 750M
            const plannedValue = totalBudget * 0.25; // 25% planned at this point
            const earnedValue = totalBudget * 0.23; // 23% actual completion
            const actualCost = 175000000; // Rp 175M spent
            
            const scheduleVariance = earnedValue - plannedValue;
            const costVariance = earnedValue - actualCost;
            const spi = earnedValue / plannedValue;
            const cpi = earnedValue / actualCost;
            
            return {
                plannedValue,
                earnedValue,
                actualCost,
                scheduleVariance,
                costVariance,
                spi,
                cpi
            };
        }

        // Update dashboard with EVM data
        function updateEVMMetrics() {
            const evm = calculateEVM();
            
            // Update SPI display
            const spiElement = document.querySelector('.kpi-card:nth-child(1) .kpi-value');
            spiElement.textContent = Math.round(evm.spi * 100) + '%';
            
            // Update CPI display  
            const cpiElement = document.querySelector('.kpi-card:nth-child(2) .kpi-value');
            cpiElement.textContent = Math.round(evm.cpi * 100) + '%';
            
            console.log('EVM Metrics Updated:', evm);
        }

        // Initialize all functions
        setTimeout(() => {
            simulateProgress();
            updateEVMMetrics();
        }, 2000);

        // Add click handlers for interactivity
        document.addEventListener('click', function(e) {
            if (e.target.closest('.metric-card')) {
                const card = e.target.closest('.metric-card');
                const title = card.querySelector('.metric-title').textContent;
                
                // Show detailed metrics modal (simplified)
                alert(`Detailed ${title} Analytics:\n\nClick OK to view comprehensive analysis for this metric.`);
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                generateReport();
            }
            if (e.ctrlKey && e.key === 'c') {
                e.preventDefault();
                highlightCriticalPath();
            }
        });

        // Auto-refresh data every 30 seconds (in production, this would call an API)
        setInterval(() => {
            updateEVMMetrics();
            
            // Simulate small progress increments
            const progressElements = document.querySelectorAll('.progress-fill');
            progressElements.forEach(element => {
                const currentWidth = parseFloat(element.style.width);
                if (currentWidth < 100) {
                    const increment = Math.random() * 0.5;
                    element.style.width = Math.min(100, currentWidth + increment) + '%';
                }
            });
        }, 30000);

        // Performance optimization
        function optimizePerformance() {
            // Lazy load chart animations
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        animateChart();
                    }
                });
            });

            const chartContainer = document.querySelector('.chart-container');
            if (chartContainer) {
                observer.observe(chartContainer);
            }
        }

        // Call optimization
        optimizePerformance();
    </script>
</body>
</html>
